<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Career Mentorship Program 8.0 - PI Feedback</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: linear-gradient(135deg, #f8fafc 0%, #e0e7ff 50%, #ddd6fe 100%);
            min-height: 100vh;
        }

        .header {
            background: white;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
            border-bottom: 1px solid #e5e7eb;
        }

        .header-content {
            max-width: 1200px;
            margin: 0 auto;
            padding: 24px 32px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .header-title h1 {
            font-size: 28px;
            font-weight: 700;
            color: #111827;
            margin-bottom: 4px;
        }

        .header-title p {
            font-size: 14px;
            color: #6b7280;
        }

        .header-icon {
            width: 48px;
            height: 48px;
            color: #4f46e5;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 32px;
        }

        .search-card {
            background: white;
            border-radius: 16px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.07);
            padding: 24px;
            margin-bottom: 24px;
        }

        .search-input-wrapper {
            position: relative;
        }

        .search-icon {
            position: absolute;
            left: 16px;
            top: 50%;
            transform: translateY(-50%);
            width: 20px;
            height: 20px;
            color: #9ca3af;
        }

        .search-input {
            width: 100%;
            padding: 16px 16px 16px 48px;
            font-size: 16px;
            border: 2px solid #d1d5db;
            border-radius: 12px;
            outline: none;
            transition: all 0.3s;
        }

        .search-input:focus {
            border-color: #4f46e5;
            box-shadow: 0 0 0 3px rgba(79, 70, 229, 0.1);
        }

        .search-results {
            margin-top: 12px;
            background: white;
            border: 1px solid #e5e7eb;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            max-height: 320px;
            overflow-y: auto;
        }

        .search-result-item {
            padding: 16px;
            border-bottom: 1px solid #f3f4f6;
            cursor: pointer;
            transition: background 0.2s;
        }

        .search-result-item:hover {
            background: #eef2ff;
        }

        .search-result-item:last-child {
            border-bottom: none;
        }

        .search-result-name {
            font-weight: 600;
            color: #111827;
            margin-bottom: 4px;
        }

        .search-result-info {
            font-size: 14px;
            color: #6b7280;
        }

        .no-results {
            padding: 24px;
            text-align: center;
            color: #6b7280;
            background: #f9fafb;
            border-radius: 12px;
        }

        .card {
            background: white;
            border-radius: 16px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.07);
            padding: 24px;
            margin-bottom: 24px;
        }

        .student-header {
            display: flex;
            justify-content: space-between;
            align-items: start;
        }

        .student-info h2 {
            font-size: 32px;
            font-weight: 700;
            color: #111827;
            margin-bottom: 12px;
        }

        .student-meta {
            font-size: 14px;
            color: #6b7280;
            margin-bottom: 4px;
        }

        .student-meta strong {
            color: #374151;
        }

        .student-timestamp {
            font-size: 12px;
            color: #9ca3af;
            margin-top: 4px;
        }

        .score-display {
            text-align: right;
        }

        .score-value {
            font-size: 40px;
            font-weight: 700;
            margin-bottom: 4px;
        }

        .score-label {
            font-size: 14px;
            color: #6b7280;
            margin-bottom: 8px;
        }

        .score-max {
            font-size: 12px;
            color: #9ca3af;
            display: flex;
            align-items: center;
            justify-content: flex-end;
            gap: 4px;
        }

        .color-green { color: #16a34a; }
        .color-blue { color: #2563eb; }
        .color-yellow { color: #ca8a04; }
        .color-red { color: #dc2626; }

        .card-title {
            font-size: 20px;
            font-weight: 600;
            color: #111827;
            margin-bottom: 24px;
        }

        .chart-container {
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px 10px;
            min-height: 350px;
            overflow: hidden;
        }

        .chart-wrapper {
            position: relative;
            width: 100%;
            max-width: 450px;
            height: 350px;
        }

        @media (max-width: 768px) {
            .chart-container {
                padding: 15px 5px;
                min-height: 320px;
            }

            .chart-wrapper {
                max-width: 100%;
                height: 320px;
            }
        }

        @media (max-width: 480px) {
            .chart-container {
                padding: 10px 0;
                min-height: 280px;
            }

            .chart-wrapper {
                height: 280px;
            }
        }

        .metrics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 16px;
        }

        .metric-box {
            background: #f9fafb;
            border-radius: 12px;
            padding: 16px;
        }

        .metric-label {
            font-size: 12px;
            color: #6b7280;
            margin-bottom: 8px;
        }

        .metric-value {
            font-size: 24px;
            font-weight: 700;
        }

        .overall-badge {
            background: linear-gradient(135deg, #eef2ff 0%, #dbeafe 100%);
            border-left: 4px solid #4f46e5;
            padding: 20px;
            border-radius: 12px;
        }

        .overall-text {
            color: #312e81;
            font-weight: 500;
            font-size: 18px;
        }

        .feedback-box {
            background: #f9fafb;
            border-radius: 12px;
            padding: 20px;
            border: 1px solid #e5e7eb;
        }

        .feedback-text {
            color: #374151;
            line-height: 1.7;
            font-size: 16px;
        }

        .empty-state {
            text-align: center;
            padding: 64px 32px;
        }

        .empty-icon {
            width: 64px;
            height: 64px;
            color: #d1d5db;
            margin: 0 auto 16px;
        }

        .empty-title {
            font-size: 20px;
            font-weight: 600;
            color: #111827;
            margin-bottom: 8px;
        }

        .empty-text {
            color: #6b7280;
        }

        .loading {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
        }

        .spinner {
            width: 48px;
            height: 48px;
            border: 4px solid #e5e7eb;
            border-top-color: #4f46e5;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-bottom: 16px;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .loading-text {
            color: #6b7280;
            font-size: 16px;
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useMemo, useRef } = React;

        function App() {
            const [searchTerm, setSearchTerm] = useState('');
            const [selectedStudent, setSelectedStudent] = useState(null);
            const [studentsData, setStudentsData] = useState([]);
            const [isLoading, setIsLoading] = useState(true);
            const chartRef = useRef(null);
            const chartInstance = useRef(null);

            useEffect(() => {
                fetch('data.csv')
                    .then(response => response.text())
                    .then(csvText => {
                        const parsed = parseCSV(csvText);
                        setStudentsData(parsed);
                        setIsLoading(false);
                    })
                    .catch(error => {
                        console.error('Error loading CSV:', error);
                        setIsLoading(false);
                    });
            }, []);

            const parseRating = (ratingStr) => {
                if (!ratingStr) return 3;
                const match = ratingStr.toString().match(/^(\d+)/);
                return match ? parseInt(match[1]) : 3;
            };

            const parseCSV = (csvText) => {
                const lines = csvText.trim().split('\n');
                const dataLines = lines.slice(1);
                
                return dataLines.map(line => {
                    const regex = /,(?=(?:(?:[^"]*"){2})*[^"]*$)/;
                    const cols = line.split(regex).map(col => col.replace(/^"|"$/g, '').trim());
                    
                    return {
                        timestamp: cols[0] || '',
                        email: cols[1] || '',
                        panelistName: cols[2] || '',
                        studentName: cols[3] || '',
                        communication: parseRating(cols[4]),
                        bodyLanguage: parseRating(cols[5]),
                        domainKnowledge: parseRating(cols[6]),
                        analyticalThinking: parseRating(cols[7]),
                        leadership: parseRating(cols[8]),
                        culturalFit: parseRating(cols[9]),
                        overall: cols[10] || '',
                        feedback: cols.slice(11).join(' ')
                    };
                });
            };

            const filteredStudents = useMemo(() => {
                if (!searchTerm) return [];
                return studentsData.filter(student =>
                    student.studentName.toLowerCase().includes(searchTerm.toLowerCase())
                );
            }, [searchTerm, studentsData]);

            const getAverageScore = (student) => {
                const total = student.communication + student.bodyLanguage + 
                            student.domainKnowledge + student.analyticalThinking + 
                            student.leadership + student.culturalFit;
                return (total / 6).toFixed(1);
            };

            const getRatingColor = (rating) => {
                if (rating >= 4.5) return 'color-green';
                if (rating >= 3.5) return 'color-blue';
                if (rating >= 2.5) return 'color-yellow';
                return 'color-red';
            };

            const handleStudentSelect = (student) => {
                setSelectedStudent(student);
                setSearchTerm('');
            };

            useEffect(() => {
                if (selectedStudent && chartRef.current) {
                    if (chartInstance.current) {
                        chartInstance.current.destroy();
                    }

                    const ctx = chartRef.current.getContext('2d');
                    chartInstance.current = new Chart(ctx, {
                        type: 'radar',
                        data: {
                            labels: [
                                'Communication',
                                'Body Language',
                                'Domain Knowledge',
                                'Analytical Thinking',
                                'Leadership',
                                'Cultural Fit'
                            ],
                            datasets: [{
                                label: 'Performance Rating',
                                data: [
                                    selectedStudent.communication,
                                    selectedStudent.bodyLanguage,
                                    selectedStudent.domainKnowledge,
                                    selectedStudent.analyticalThinking,
                                    selectedStudent.leadership,
                                    selectedStudent.culturalFit
                                ],
                                backgroundColor: 'rgba(79, 70, 229, 0.2)',
                                borderColor: 'rgb(79, 70, 229)',
                                borderWidth: 2,
                                pointBackgroundColor: 'rgb(79, 70, 229)',
                                pointBorderColor: '#fff',
                                pointHoverBackgroundColor: '#fff',
                                pointHoverBorderColor: 'rgb(79, 70, 229)',
                                pointRadius: 4,
                                pointHoverRadius: 6
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: true,
                            layout: {
                                padding: {
                                    top: 20,
                                    bottom: 20,
                                    left: 10,
                                    right: 10
                                }
                            },
                            scales: {
                                r: {
                                    beginAtZero: true,
                                    max: 5,
                                    min: 0,
                                    ticks: {
                                        stepSize: 1,
                                        font: {
                                            size: 11
                                        },
                                        backdropPadding: 2
                                    },
                                    pointLabels: {
                                        font: {
                                            size: window.innerWidth < 480 ? 10 : 12,
                                            weight: '500'
                                        },
                                        padding: window.innerWidth < 480 ? 5 : 10
                                    },
                                    grid: {
                                        color: 'rgba(0, 0, 0, 0.1)'
                                    }
                                }
                            },
                            plugins: {
                                legend: {
                                    display: true,
                                    position: 'bottom',
                                    labels: {
                                        padding: 15,
                                        font: {
                                            size: 12
                                        },
                                        boxWidth: 15,
                                        boxHeight: 15
                                    }
                                }
                            }
                        }
                    });
                }

                return () => {
                    if (chartInstance.current) {
                        chartInstance.current.destroy();
                    }
                };
            }, [selectedStudent]);

            if (isLoading) {
                return (
                    <div className="loading">
                        <div className="spinner"></div>
                        <p className="loading-text">Loading student data...</p>
                    </div>
                );
            }

            return (
                <>
                    <div className="header">
                        <div className="header-content">
                            <div className="header-title">
                                <h1>Career Mentorship Program <span style={{color: '#ea580c'}}>8.0</span></h1>
                                <p>PI Feedback Dashboard</p>
                            </div>
                            <svg className="header-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 12l2 2 4-4M7.835 4.697a3.42 3.42 0 001.946-.806 3.42 3.42 0 014.438 0 3.42 3.42 0 001.946.806 3.42 3.42 0 013.138 3.138 3.42 3.42 0 00.806 1.946 3.42 3.42 0 010 4.438 3.42 3.42 0 00-.806 1.946 3.42 3.42 0 01-3.138 3.138 3.42 3.42 0 00-1.946.806 3.42 3.42 0 01-4.438 0 3.42 3.42 0 00-1.946-.806 3.42 3.42 0 01-3.138-3.138 3.42 3.42 0 00-.806-1.946 3.42 3.42 0 010-4.438 3.42 3.42 0 00.806-1.946 3.42 3.42 0 013.138-3.138z" />
                            </svg>
                        </div>
                    </div>

                    <div className="container">
                        <div className="search-card">
                            <div className="search-input-wrapper">
                                <svg className="search-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
                                </svg>
                                <input
                                    type="text"
                                    className="search-input"
                                    placeholder="Search for a student by name..."
                                    value={searchTerm}
                                    onChange={(e) => setSearchTerm(e.target.value)}
                                />
                            </div>

                            {searchTerm && filteredStudents.length > 0 && (
                                <div className="search-results">
                                    {filteredStudents.map((student, idx) => (
                                        <div
                                            key={idx}
                                            className="search-result-item"
                                            onClick={() => handleStudentSelect(student)}
                                        >
                                            <div className="search-result-name">{student.studentName}</div>
                                            <div className="search-result-info">
                                                Average Score: {getAverageScore(student)}/5.0 â€¢ Evaluated by {student.panelistName}
                                            </div>
                                        </div>
                                    ))}
                                </div>
                            )}

                            {searchTerm && filteredStudents.length === 0 && (
                                <div className="no-results">
                                    No students found matching "{searchTerm}"
                                </div>
                            )}
                        </div>

                        {selectedStudent ? (
                            <>
                                <div className="card">
                                    <div className="student-header">
                                        <div className="student-info">
                                            <h2>{selectedStudent.studentName}</h2>
                                            <div className="student-meta">
                                                Evaluated by: <strong>{selectedStudent.panelistName}</strong>
                                            </div>
                                            <div className="student-timestamp">
                                                {selectedStudent.timestamp}
                                            </div>
                                        </div>
                                        <div className="score-display">
                                            <div className={`score-value ${getRatingColor(parseFloat(getAverageScore(selectedStudent)))}`}>
                                                {getAverageScore(selectedStudent)}
                                            </div>
                                            <div className="score-label">Average Score</div>
                                            <div className="score-max">
                                                <svg width="12" height="12" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M13 7h8m0 0v8m0-8l-8 8-4-4-6 6" />
                                                </svg>
                                                out of 5.0
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div className="card">
                                    <h3 className="card-title">Performance Metrics</h3>
                                    
                                    <div className="chart-container">
                                        <div className="chart-wrapper">
                                            <canvas ref={chartRef}></canvas>
                                        </div>
                                    </div>

                                    <div className="metrics-grid">
                                        <div className="metric-box">
                                            <div className="metric-label">Communication Skills</div>
                                            <div className={`metric-value ${getRatingColor(selectedStudent.communication)}`}>
                                                {selectedStudent.communication}/5
                                            </div>
                                        </div>
                                        <div className="metric-box">
                                            <div className="metric-label">Body Language</div>
                                            <div className={`metric-value ${getRatingColor(selectedStudent.bodyLanguage)}`}>
                                                {selectedStudent.bodyLanguage}/5
                                            </div>
                                        </div>
                                        <div className="metric-box">
                                            <div className="metric-label">Domain Knowledge</div>
                                            <div className={`metric-value ${getRatingColor(selectedStudent.domainKnowledge)}`}>
                                                {selectedStudent.domainKnowledge}/5
                                            </div>
                                        </div>
                                        <div className="metric-box">
                                            <div className="metric-label">Analytical Thinking</div>
                                            <div className={`metric-value ${getRatingColor(selectedStudent.analyticalThinking)}`}>
                                                {selectedStudent.analyticalThinking}/5
                                            </div>
                                        </div>
                                        <div className="metric-box">
                                            <div className="metric-label">Leadership Potential</div>
                                            <div className={`metric-value ${getRatingColor(selectedStudent.leadership)}`}>
                                                {selectedStudent.leadership}/5
                                            </div>
                                        </div>
                                        <div className="metric-box">
                                            <div className="metric-label">Cultural Fit & Attitude</div>
                                            <div className={`metric-value ${getRatingColor(selectedStudent.culturalFit)}`}>
                                                {selectedStudent.culturalFit}/5
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div className="card">
                                    <h3 className="card-title">Overall Interview Performance</h3>
                                    <div className="overall-badge">
                                        <div className="overall-text">{selectedStudent.overall}</div>
                                    </div>
                                </div>

                                <div className="card">
                                    <h3 className="card-title">Qualitative Feedback & Comments</h3>
                                    <div className="feedback-box">
                                        <div className="feedback-text">{selectedStudent.feedback}</div>
                                    </div>
                                </div>
                            </>
                        ) : (
                            <div className="card empty-state">
                                <svg className="empty-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
                                </svg>
                                <h3 className="empty-title">Search for a Student</h3>
                                <p className="empty-text">Use the search bar above to find and view student performance data</p>
                            </div>
                        )}
                    </div>
                </>
            );
        }

        ReactDOM.render(<App />, document.getElementById('root'));
    </script>
</body>
</html>
